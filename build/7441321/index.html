
    <head>
      <link href="http://cdn.bootcss.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet">
      <link href="./style.css" rel="stylesheet">
    </head>
    <body><p>动态数据及分析结果的访问，下面三类，都是通过REST访问：</p><ol><li>分析结果查询接口：用于查询存储分析结果的Mysql数据；</li><li>统计结果查询接口：用于查询存储统计结果的Mysql数据；</li><li>动态数据查询接口：用于查询Impala表中的动态数据；</li></ol><p>&nbsp;</p><p>下面逐一介绍上述接口的使用过程。</p><h2><strong>一、分析结果REST查询接口</strong></h2><pre><code>GET /pas/services/results
Accept: application/json</code></pre><p>实际用例：查询某次健康评估任务的执行结果（按照分析任务id查询分析结果）</p><pre><code>http://192.168.130.115:8083/pas/services/results?projectId=100272&instanceId=21136</code></pre><p>返回结果：</p><pre><code>{
  "message": "",
  "body": {
    "items": [
      {
        "windspeed": 0,
        "endtime": "start_time",
        "gw_date": "tid",
        "turbineno": "analyse_type",
        "fltdurattion": 0,
        "gw_interval": "fid",
        "farmid": "model_name",
        "production": 0,
        "productionduration": 0
      },
      {
        "windspeed": 411201001,
        "endtime": "2016-01-19",
        "gw_date": "411201001",
        "turbineno": "index",
        "fltdurattion": 5.42,
        "gw_interval": "411201",
        "farmid": "power_production",
        "production": 2016,
        "productionduration": 0
      }
    ],
    "pageInfo": {
      "total": 2,
      "pages": 1,
      "pageSize": 1000,
      "pageNum": 1
    }
  },
  "code": 0
}</code></pre><p>&nbsp;</p><h2><strong>二、统计结果REST查询接口</strong></h2><p>接口调用：</p><pre><code>POST /data-rows
GET /data-rows?query=
Accept: application/json</code></pre><p>实际用例：查询某时间段内某风机工作的启止时间（按照时间段查询某风机动态数据中time字段的max值和min值）</p><pre><code>{
    "timeRange": {
        "start": "2016-01-01T00:00:00.000Z",   
        "end": "2016-02-01T00:00:00.000Z"
    },
    "fieldGroup": "sample_fieldGroup",
    "coValueFilter": {
        "idFieldFilter": {
            "or": [
                {
                    "IDF_wnIdx_STRING_000": { "$eq": "FG_wnIdx_000_A_004_IDF_wnIdx_STRING_000" },
                    "IDF_wnIdx_STRING_001": { "$eq": "FG_wnIdx_000_A_004_IDF_wnIdx_STRING_001" },
                    "IDF_wnIdx_STRING_002": { "$eq": "FG_wnIdx_000_A_004_IDF_wnIdx_STRING_002" }
                }
            ]
        }
    },
    "fields": ["time"],
    "aggregations": [
        { "$default": ["max","min"] }
    ],
    "aggregationOptions": {
        "interval": "1d"
    },  
    "groupBy": [],
    "size": 20,
    "page": 1,
    "options": {
        "resultTimeFormat": "iso"
    }
}</code></pre><p>&nbsp;</p><p>返回结果：</p><pre><code>{
  "code": 0,
  "message": "",
  "results": [{
      "pageInfo": { "size": 2, "pageNum": 1, "pageSize": 20 },
      "fields": [ "time-max", "time-min" ],
      "rows": [{
            "timestamp": "2016-01-01T00:00:00.000Z",
            "values": [ "2016-01-01T01:10:10.000Z", "2016-01-30T23:50:50.000Z"]
        }]
  }]
}</code></pre><h2><strong>三、动态数据REST查询接口</strong></h2><p>接口调用：</p><pre><code>GET data-service/v4/data-rows?query=
Accept: application/json</code></pre><p>实际用例：查询满足条件（fid=&quot;411201&quot;, tid=&quot;411201001&quot;, type=&quot;7s&quot;），且时间范围是1451577600000 ~&nbsp;1451647600000之间的所有动态数据，用于如下绘制履历档案</p><pre><code>http://192.168.130.115:8089/data-service/v4/data-rows?query=
{
  "timeseries": [
    {
      "fields": [
        "wnac_wspd_instmag_f",
        "wtur_pwrat_instmag_f"
      ],
      "timeRange": {
        "start": 1451577600000,
        "end": 1451647600000
      },
      "coValueFilter": {
        "idFieldFilter": {
          "fid": {
            "$eq": "411201"
          },
          "tid": {
            "$eq": "411201001"
          },
          "type": {
            "$eq": "7s"
          }
        }
      },
      "order": "asc",
      "size": 10000,
      "page": 1,
      "options": {
        "resultTimeFormat": "iso"
      }
    }
  ]
}</code></pre><p>返回结果：</p><pre><code>{
  "code": 0,
  "message": "",
  "results": [
    {
      "pageInfo": {
        "pageNum": 1,
        "pageSize": 10000,
        "size": 10000
      },
      "compoundId": {
        "fid": "411201",
        "tid": "411201001",
        "type": "7s"
      },
      "fields": [
        "wnac_wspd_instmag_f",
        "wtur_pwrat_instmag_f"
      ],
      "rows": [
        {
          "values": [
            4.380000114440918,
            105.83000183105469
          ],
          "iso": "2016-01-01T00:00:02.000+08:00"
        }
      ]
    }
  ]
}</code></pre></body>
  